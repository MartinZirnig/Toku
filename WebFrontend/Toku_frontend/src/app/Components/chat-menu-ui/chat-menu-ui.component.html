<div #chatMenuContainer>
  <div
    [hidden]="!menuService.showDropdown"
    [ngClass]="{
      'animate-fade-in-right': menuService.isVisible,
      'animate-fade-out-left': !menuService.isVisible
    }"
    class="fixed top-0 left-0 h-[90vh] max-h-[85vh] origin-top-right rounded-lg w-96 shadow-2xl bg-gray-900 flex flex-col"
    style="height: 100%; max-height: 100vh; overflow-y: auto; scrollbar-width: none; -ms-overflow-style: none;"
  >
    <style>
      div::-webkit-scrollbar {
        display: none;
      }
    </style>

    <!-- Header: Edit + Search -->
    <div class="sticky top-0 z-10 bg-gray-900 pt-4 pb-2 px-6 flex items-center gap-3">
      <!-- Edit Button -->
      <button
        (click)="onEditClick()"
        [ngClass]="{'bg-blue-600': activeMenuService.inEditMode, 'bg-gray-700': !activeMenuService.inEditMode}"
        class="w-11 h-11 hover:bg-blue-700 transition-all duration-300 cursor-pointer rounded-full flex items-center justify-center shadow"
        title="Edit chats"
      >
        <svg class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none">
          <path d="M18 2L22 6M2 22L3.2764 17.3199C3.35968 17.0145 3.40131 16.8619 3.46523 16.7195C3.52199 16.5931 3.59172 16.4729 3.67332 16.3609C3.76521 16.2348 3.87711 16.1229 4.1009 15.8991L14.4343 5.56569C14.6323 5.36768 14.7313 5.26867 14.8455 5.23158C14.9459 5.19895 15.0541 5.19895 15.1545 5.23158C15.2687 5.26867 15.3677 5.36768 15.5657 5.56569L18.4343 8.43431C18.6323 8.63232 18.7313 8.73133 18.7684 8.84549C18.8011 8.94591 18.8011 9.05409 18.7684 9.15451C18.7313 9.26867 18.6323 9.36768 18.4343 9.56569L8.1009 19.8991C7.87711 20.1229 7.76521 20.2348 7.63908 20.3267C7.52709 20.4083 7.40692 20.478 7.28052 20.5348C7.13815 20.5987 6.98548 20.6403 6.68014 20.7236L2 22Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
      </button>
      <!-- Search Input -->
      <div class="flex items-center bg-gray-800 rounded-full px-4 py-2 flex-1 shadow">
        <svg class="w-5 h-5 text-gray-400 mr-2" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
          <line x1="21" y1="21" x2="16.65" y2="16.65" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <input
          [(ngModel)]="search"
          (input)="onSearch()"
          type="text"
          placeholder="Search chats..."
          class="bg-transparent outline-none border-none text-white placeholder-gray-400 w-full"
        />
      </div>
      <!-- Add Button (Visible in Edit Mode) -->
      <button
        *ngIf="activeMenuService.inEditMode"
        class="w-11 h-11 bg-green-600 hover:bg-green-700 transition-all duration-300 cursor-pointer rounded-full flex items-center justify-center shadow"
        (click)="appendGroup()"
        title="Add new chat"
      >
        <svg class="w-6 h-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
        </svg>
      </button>
    </div>

    <!-- Chat Items Section -->
    <div class="flex-1 overflow-y-auto px-2 pb-4 space-y-2">
      <app-active-group
        *ngFor="let item of filteredItems"
        [data]="item"
        [active]="item.groupId === activeGroupId">
      </app-active-group>
    </div>
  </div>
</div>

