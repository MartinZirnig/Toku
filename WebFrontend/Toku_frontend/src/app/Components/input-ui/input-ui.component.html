<div>
    <div class="input-bar backdrop-blur-xs">
        <!-- Pin Button -->
        <button
            id="pin-button"
            [ngClass]="{'has-files': hasFiles}"
            (click)="toggleFileForm()"
        >
            <span *ngIf="hasFiles" class="file-count-circle">
                {{ fileCount }}
            </span>
            <svg *ngIf="!hasFiles" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 8v.01M4 16v.01M4 12v.01M8 4h.01M16 4h.01M12 4h.01M20 12v.01M20 8v.01M20 16v.01M16 20h.01M8 20h.01M12 20h.01M12 16l-4-4 4-4"
                />
            </svg>
        </button>

        <!-- Emoji Button -->
        <button id="emoji-button" (click)="toggleEmojiPopup()">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9.172 9.172a4 4 0 015.656 0M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
        </button>

        <!-- Textarea -->
        <div class="custom-scrollbar-container" #customScrollbarContainer>
            <textarea 
                id="chat-textarea" 
                #chatTextarea
                placeholder="Napište zprávu..." 
                (input)="onInput()"
                (scroll)="onScroll()"
            ></textarea>
            <!-- Vlastní scrollbar -->
            <div class="custom-scrollbar-track" #customScrollbarTrack>
                <div id="custom-scrollbar-thumb" class="custom-scrollbar-thumb" #customScrollbarThumb (mousedown)="onThumbMouseDown($event)"></div>
            </div>
        </div>

        <!-- Emoji Popup -->
        <div *ngIf="emojiPopupService.emojiPopupVisible" class="absolute bottom-full left-1/2" style="transform:translateX(-50%);margin-bottom:0.5rem;z-index:50;">
            <app-emoji (emojiSelected)="onEmojiSelected($event)"></app-emoji>
        </div>

        <!-- Send Button -->
        <button id="send-button" (click)="send()">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
            </svg>
        </button>
    </div>
</div>

<app-file-form *ngIf="isFileFormVisible"></app-file-form>