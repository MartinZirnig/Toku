<div class="relative flex justify-start items-center mx-auto touch-pan-y select-none" 
  (contextmenu)="onRightClick($event)">
  <!-- Wrapper for message and menu -->
  <div class="relative flex items-center">
    <div style="width: 100%; max-width: 50vw; min-width: 10vw;">
      <!-- Message content -->
      <div class="p-4 rounded-lg shadow-md relative backdrop-blur-md bg-white/80 text-gray-800 break-words" [ngClass]="{'long-text': isLongText}">
        <!-- Image content -->
        <img *ngIf="image" [src]="image" alt="Message Image" class="mb-2 rounded-lg max-w-full">
        <!-- Text content -->
        <p *ngIf="text" class="text-gray-800">{{ text }}</p>
        <div class="mt-5 flex">
          <!-- Time -->
          <div class="absolute bottom-2 right-2 flex items-center text-gray-500 text-sm space-x-2">
            <span>{{ time }}</span>
            <div class="w-7 h-7 bg-gray-500/80 rounded-full flex items-center justify-center">
              <svg class="w-4 h-4 text-white/90" viewBox="0 0 24 24">
                <path fill="currentColor" d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
              </svg>
            </div>
          </div>
        </div>
      </div>
    </div>
    <app-reaction-counter class="absolute left-[1rem] z-50 bottom-[-0.5rem]" [reactionsData]="reactionsData"></app-reaction-counter>
    <!-- Three-dot menu -->
    <div class="ml-2 cursor-pointer z-20" (click)="toggleMenu($event)" #menuTrigger>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-500 hover:text-gray-700" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" viewBox="0 0 1080 1080" xml:space="preserve">
        <g transform="matrix(1 0 0 1 540 540)" id="1cdcc9a0-494f-4c4a-a55c-3f055ece675c"></g>
        <g transform="matrix(45 0 0 45 423.5 753.5)">
          <circle vector-effect="non-scaling-stroke" cx="0" cy="0" r="2" fill="currentColor" />
        </g>
        <g transform="matrix(45 0 0 45 751.51 540)">
          <circle vector-effect="non-scaling-stroke" cx="0" cy="0" r="2" fill="currentColor" />
        </g>
        <g transform="matrix(45 0 0 45 424 324)">
          <circle vector-effect="non-scaling-stroke" cx="0" cy="0" r="2" fill="currentColor" />
        </g>
      </svg>
    </div>
  </div>
  <!-- Context menu -->
  <div *ngIf="menuVisible" class="absolute top-0 left-[103%] bg-gray-800/30 backdrop-blur-md shadow-md text-white rounded-lg z-50 p-2 w-48">
    <ul class="list-none m-0 p-0">
      
      <li class="flex items-center px-4 py-2 hover:bg-gray-200/30 cursor-pointer" (click)="onDelete()">
        <svg class="h-5 w-5 mr-2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/1999/xlink">
          <path d="M9 3H15M3 6H21M19 6L18.2987 16.5193C18.1935 18.0975 18.1409 18.8867 17.8 19.485C17.4999 20.0118 17.0472 20.4353 16.5017 20.6997C15.882 21 15.0911 21 13.5093 21H10.4907C8.90891 21 8.11803 21 7.49834 20.6997C6.95276 20.4353 6.50009 20.0118 6.19998 19.485C5.85911 18.8867 5.8065 18.0975 5.70129 16.5193L5 6M10 10.5V15.5M14 10.5V15.5" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
        Smazat
      </li>
      <li class="flex items-center px-4 py-2 hover:bg-gray-200/30 cursor-pointer">
        <svg class="h-5 w-5 mr-2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/1999/xlink">
          <path d="M9 14L4 9M4 9L9 4M4 9H10.4C13.7603 9 15.4405 9 16.7239 9.65396C17.8529 10.2292 18.7708 11.1471 19.346 12.2761C20 13.5595 20 15.2397 20 18.6V20" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
        Odpovědět
      </li>
      <li class="flex items-center px-4 py-2 hover:bg-gray-200/30 cursor-pointer">
        <svg class="h-5 w-5 mr-2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/1999/xlink">
          <path d="M15 9H15.01M9 9H9.01M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12ZM15.5 9C15.5 9.27614 15.2761 9.5 15 9.5C14.7239 9.5 14.5 9.27614 14.5 9C14.5 8.72386 14.7239 8.5 15 8.5C15.2761 8.5 15.5 8.72386 15.5 9ZM9.5 9C9.5 9.27614 9.27614 9.5 9 9.5C8.72386 9.5 8.5 9.27614 8.5 9C8.5 8.72386 8.72386 8.5 9 8.5C9.27614 8.5 9.5 8.72386 9.5 9ZM12 17.5C14.5005 17.5 16.5 15.667 16.5 14H7.5C7.5 15.667 9.4995 17.5 12 17.5Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
        Reagovat 
      </li>
      <li class="flex items-center px-4 py-2 hover:bg-gray-200/30 cursor-pointer">
        <svg class="h-5 w-5 mr-2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/1999/xlink">
          <path d="M5 15C4.06812 15 3.60218 15 3.23463 14.8478C2.74458 14.6448 2.35523 14.2554 2.15224 13.7654C2 13.3978 2 12.9319 2 12V5.2C2 4.0799 2 3.51984 2.21799 3.09202C2.40973 2.71569 2.71569 2.40973 3.09202 2.21799C3.51984 2 4.0799 2 5.2 2H12C12.9319 2 13.3978 2 13.7654 2.15224C14.2554 2.35523 14.6448 2.74458 14.8478 3.23463C15 3.60218 15 4.06812 15 5M12.2 22H18.8C19.9201 22 20.4802 22 20.908 21.782C21.2843 21.5903 21.5903 21.2843 21.782 20.908C22 20.4802 22 19.9201 22 18.8V12.2C22 11.0799 22 10.5198 21.782 10.092C21.5903 9.71569 21.2843 9.40973 20.908 9.21799C20.4802 9 19.9201 9 18.8 9H12.2C11.0799 9 10.5198 9 10.092 9.21799C9.71569 9.40973 9.40973 9.71569 9.21799 10.092C9 10.5198 9 11.0799 9 12.2V18.8C9 19.9201 9 20.4802 9.21799 20.908C9.40973 21.2843 9.71569 21.5903 10.092 21.782C10.5198 22 11.0799 22 12.2 22Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
        Kopírovat
      </li>
    </ul>
  </div>
</div>
